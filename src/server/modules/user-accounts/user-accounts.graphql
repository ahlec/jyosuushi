type UserAccount {
  dateRegistered: Date!
  username: String!
}

extend type Query {
  activeUser: UserAccount
}

extend type Mutation {
  login(email: String!, password: String!): LoginPayload!
  registerAccount(email: String!, password: String!): RegisterAccountPayload!
}

enum RegisterAccountError {
  # Email-related validation errors
  EMAIL_EMPTY
  EMAIL_INVALID_FORMAT

  # Password-related validation errors
  PASSWORD_TOO_SHORT
  PASSWORD_MISSING_NUMERAL

  # Registration errors
  ACCOUNT_ALREADY_EXISTS
  ALREADY_AUTHENTICATED
}

type RegisterAccountPayload {
  error: RegisterAccountError
  user: UserAccount
}

enum LoginError {
  # Validation errors
  EMAIL_EMPTY
  PASSWORD_EMPTY

  # Login errors
  EMAIL_PASSWORD_COMBINATION_INCORRECT
  ALREADY_AUTHENTICATED
  TOO_MANY_INCORRECT_ATTEMPTS_SLOW_DOWN
}

type LoginPayload {
  error: LoginError
  user: UserAccount
}
